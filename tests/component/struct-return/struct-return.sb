#include "tests-common.sb"

struct Money {
    u64 dollars;
    u8 cents;
};

fun memcpy(any *dst, any *src, u64 size)
{
    u8 *dstB = dst;
    u8 *srcB = src;
    u64 idx = 0;
    while(idx < size)
    {
        dstB[idx] = srcB[idx];
        idx += 1;
    }
}


impl Money {
    public Money fun Add(self, Money m2) {
        Money added;
        added.cents = self.cents + m2.cents;

        added.dollars = self.dollars + m2.dollars;
        if(added.cents >= 100)
        {
            added.dollars += 1;
            added.cents %= 100;
        }

        return added;        
    }

    public fun SetValue(self, u64 dollars, u8 cents)
    {
        self.dollars = dollars;
        self.cents = cents;
    }

    public fun Print(self)
    {
        printNum((u32)self.dollars);
        uart_putc('.');
        printNum(self.cents);
    }
};

fun main()
{
    Money myBalance;

    myBalance.SetValue(13, 33);
    myBalance.Print();


    Money myPaycheck;
    myPaycheck.SetValue(999, 99);
    myPaycheck.Print();

    Money newBalance = myBalance.Add(myPaycheck);

    exit();
}
