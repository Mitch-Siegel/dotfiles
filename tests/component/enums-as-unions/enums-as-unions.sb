#include "tests-common.sb"

struct Vec3
{
    public u32 x;
    public u32 y;
    public u32 z;
};

enum Instruction {
    SetSize: Vec3,
    ScaleUp: u32,
    ScaleDown: u32, 
    Translate: Vec3,
    Print,
};

struct State{
    Vec3 size;
    Vec3 pos;
};

impl State {
    public fun DoInstruction(self, Instruction instructionToDo)
    {
        match(instructionToDo)
        {
            SetSize(size): 
                {
                    self.size.x = size.x;
                    self.size.y = size.y;
                    self.size.z = size.z;
                }
            ScaleUp(factor): 
                {
                    self.size.x *= factor;
                    self.size.y *= factor;
                    self.size.z *= factor;
                }
            ScaleDown(factor): 
                {
                    self.size.x *= factor;
                    self.size.y *= factor;
                    self.size.z *= factor;
                }
            Translate: printStr("Translate!\n");
            Print: printStr("Print!\n");
        }
    }
}

fun printInstruction(Instruction toPrint) {
    match(toPrint)
    {
        SetSize(sz): {
            printStr("SetSize\n");
            printNum(sz.x);
            uart_putc('\n');
            printNum(sz.y);
            uart_putc('\n');
            printNum(sz.z);
            uart_putc('\n');
            }
        ScaleUp(scale): {printStr("Scale Up\n"); printNum(scale); }
        ScaleDown: printStr("Scale Down\n");
        Translate: printStr("Translate\n");
        Print: printStr("Print\n");
    }
}

fun testInstructions()
{
    State s;
    //Instruction i = SetSize({x = 1, y = 2, z = 3});
    Instruction i = ScaleUp(1234);
    printInstruction(i);
    //printInstruction(ScaleUp);
    //printInstruction(ScaleDown);
    //printInstruction(Translate);
    //printInstruction(Print);
}

fun main()
{
    testInstructions();
    exit();
}